#!/usr/bin/env python3

from redis import StrictRedis
import sys

IP = sys.argv[1]
PORT = 6379

PASSWORD = None
DATABASE = 0
PREFIX = ''

redis = StrictRedis(host=IP, port=PORT, db=DATABASE, password=PASSWORD)

for key in redis.scan_iter(match=f'{PREFIX}*'):
    print(key, flush=True)
    key_type = redis.type(key)
    try:
        if key_type == b'string':
            result = redis.get(key)
        elif key_type == b'set':
            result = redis.smembers(key)
        elif key_type == b'hash':
            result = redis.hgetall(key)
        elif key_type == b'list':
            result = redis.lrange(key, 0, -1)
        elif key_type == b'zset':
            result = redis.zrange(key, 0, -1)
        else:
            result = redis.get(key)
        print(result, flush=True)
    except:
        continue
